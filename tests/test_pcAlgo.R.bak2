library(pcalg)

set.seed(2)

## Parameters
p <- 5
n <- 1000
alpha <- 0.05
s <- 0.6

mlb <- 0.1
mub <- 1
dag <- randomDAG(p,s,lB=mlb,uB=mub)
data <- rmvDAG(n, dag)
## TODO: improve this, once we have print(),plot() methods:
estdag <- pcAlgo(data,alpha, verbose=TRUE)$graph

if(dev.interactive()) {
 par(mfrow=c(1,2))
 plot(dag);    title("true")
 plot(estdag); title("estimate")
}

## check TPR, FPR and TDR for randomly generated data
dag <- randomDAG(p,s,lB=mlb,uB=mub)
data <- rmvDAG(n, dag)
estdag <- pcAlgo(data,alpha,verbose=TRUE)$graph
res <- compareGraphs(estdag, dag)
if (abs(round(res["tpr"]-0.83333333333,10))>1e-10)
    stop("Inconsistent result in Testing test_pcAlgo.R")

if(dev.interactive()) {
 par(mfrow=c(1,2))
 plot(dag)
 title("true")
 plot(estdag)
 title(paste("estimate - TPR:", round(res$tpr,3),
             "FPR:",round(res$fpr,3),"TDR:",round(res$tdr,3),sep=""))
}

